services:
  - type: web
    name: datazone-web-api
    env: docker
    dockerfilePath: ./DataZone-web-api/Dockerfile
    buildCommand: ""  # Optional: command to build the service
    startCommand: ""  # Optional: command to start the service
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Development
    ports:
      - port: 8888
    disk:
      name: shared-data
      mountPath: /shared-data

  - type: web
    name: pg-admin-ui
    env: docker
    dockerCommand: docker run --name pg-admin-ui -e PGADMIN_DEFAULT_EMAIL=yosephhabtamu5@gmail.com -e PGADMIN_DEFAULT_PASSWORD=123456 -p 82:80 dpage/pgadmin4
    ports:
      - port: 80
        targetPort: 82

  - type: web
    name: datazone-analytics-server-exploratory
    env: docker
    dockerfilePath: ./DataZone-analytics-server/Dockerfile
    startCommand: poetry run python main.py exploratory
    disk:
      name: shared-data
      mountPath: /shared-data

  - type: web
    name: datazone-analytics-server-regression
    env: docker
    dockerfilePath: ./DataZone-analytics-server/Dockerfile
    startCommand: poetry run python main.py regression
    disk:
      name: shared-data
      mountPath: /shared-data

  - type: web
    name: datazone-analytics-server-visualization
    env: docker
    dockerfilePath: ./DataZone-analytics-server/Dockerfile
    startCommand: poetry run python main.py visualization
    disk:
      name: shared-data
      mountPath: /shared-data

  - type: web
    name: datazone-message
    env: docker
    dockerfilePath: ./rabbitmq/Dockerfile
    ports:
      - port: 5672
      - port: 15672

databases:
  - type: postgresql
    name: datazone
    plan: standard
    envVars:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: 123456
      POSTGRES_DB: datazone
    disk:
      name: shared-data
      mountPath: /shared-data
